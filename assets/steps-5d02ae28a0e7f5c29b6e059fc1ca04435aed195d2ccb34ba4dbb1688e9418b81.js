(()=>{document.addEventListener("DOMContentLoaded",d);document.addEventListener("turbo:render",d);window.jQuery.ui;function d(){var n=window.location.href,t=p(n);if(!isNaN(t)){var e=new URLSearchParams(window.location.search),a=e.get("step_id");if(a){var s=$(".step-list-item[data-step-id='"+a+"']");s.length>0&&(s.addClass("active"),l(a,t))}else{var c=v(t),s=$(".step-list-item:eq("+c+")");if(s.length>0){s.addClass("active");var m=s.data("step-id")}}$(".clickable-column").on("click",function(){var i=$(this).data("href");i&&(window.location.href=i)}),$(".step-list-item").on("click",function(i){i.preventDefault(),$(".step-list-item").removeClass("active"),$(this).addClass("active");var r=$(this).data("step-id");l(r,t)});var t=window.location.pathname.match(/\/funnels\/(\d+)/);if(t&&t[1]){t=parseInt(t[1]);var u=$("meta[name=csrf-token]").attr("content");$(".step-list").sortable({update:function(i,r){var o=[];$(this).find(".step-list-item").each(function(){o.push($(this).data("step-id"))}),$.ajax({url:"/funnels/"+t+"/update_step_order",type:"PUT",data:{stepIds:o},headers:{"X-CSRF-Token":u},success:function(f){},error:function(f,w,g){}})}})}}}function p(n){var t=n.split("/"),e=t[t.length-1],a=parseInt(e);return isNaN(a)?0:a}function v(n){for(var t=$(".step-list-item"),e=0;e<t.length;e++){var a=$(t[e]);if(a.data("funnel-id")==n)return e}return 0}function l(n,t){!isNaN(t)&&n>0?$.ajax({url:`/funnels/${t}/steps/${n}/details`,type:"GET",dataType:"script",success:function(e){},error:function(e,a,s){e.status===404?console.log(`Step with ID ${n} doesn't exist for funnel with ID ${t}`):console.error(`Error loading step details: ${s}`)}}):h()}function h(){$("#step-details").empty()}})();

